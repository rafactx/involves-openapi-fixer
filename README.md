# OpenAPI Fixer & Enhancer

A professional, configuration-driven tool to automatically process, clean, validate, and enrich raw OpenAPI 3.x specifications. This script transforms machine-generated specs into a world-class, interactive, and developer-friendly documentation artifact.

It was designed to fix common issues found in specs generated by build tools, such as missing metadata, inconsistent naming, and lack of examples, making them fully compatible with tools like **Stoplight, Swagger UI, and Redoc**.

## Key Features

This script provides a powerful pipeline of automated enhancements:

  - ✅ **Configuration-Driven Workflow:** Centrally manage all rules, metadata, server URLs with variables, security schemes, and error responses via a single `config.yaml` file. No more hard-coded values.
  - ✅ **Component Centralization (DRY):** Automatically refactors the spec to use reusable components for `parameters`, `responses`, and `requestBodies`, following the "Don't Repeat Yourself" principle.
  - ✅ **Rich & Realistic Example Generation:** Integrates the **Faker** library to produce realistic and valid examples for response bodies. The generator is smart enough to respect schema constraints like `enum`, `minimum`, and `maximum`.
  - ✅ **Full Internationalization:** Translates all descriptions, summaries, and titles using a single, consolidated `dictionary.json`, making the API documentation fully localized.
  - ✅ **Automated Cleanup & Standardization:**
      - Sorts top-level tags alphabetically for better organization.
      - Fixes invalid component names (e.g., removing spaces) and updates all `$ref` values accordingly.
      - Assigns placeholder `operationId`s if they are missing.
  - ✅ **Robust Response Handling:**
      - Ensures every operation has at least one success response (`2xx`), adding a default `204 No Content` if missing.
      - Injects standardized error responses (`4xx`, `5xx`) from the configuration file.
  - ✅ **Resilient Architecture:** Utilizes a multi-pass processing system to first analyze the structure, then build components, and finally replace inline definitions. This robust approach prevents common reference errors and orphaned components.

-----

## Final Project Structure

For the script to run with default settings, your project should be organized as follows:

```
involves-openapi-fixer/
│
├── dist/                     # Default output directory (auto-generated)
│   └── openapi.fixed.yaml    # The final, enhanced OpenAPI file
│
├── config.yaml               # Main configuration file for all rules
├── dictionary.json           # Consolidated dictionary for all translations
├── fix_openapi.py            # The command-line interface (CLI) to run the script
├── openapi.yaml              # The original, raw OpenAPI specification file
├── openapi_processor.py      # The core processing engine class
├── README.md                 # This file
└── requirements.txt          # Project dependencies
```

-----

## How to Use

### 1\. Installation

First, install the required Python libraries:

```bash
pip install -r requirements.txt
```

### 2\. Configuration

Before running, customize the following files to match your API's needs:

  - **`config.yaml`**: This is your main control panel. Adjust the `metadata`, `servers`, `security_schemes`, `tag_map`, and other sections.
  - **`dictionary.json`**: Ensure this file contains all the translation keys (`api.doc...`) and their corresponding descriptions.
  - **`openapi.yaml`**: This is your source file that the script will process.

### 3\. Execution

With the configuration files ready, run the script from the project's root directory.

**To run with default file paths:**

```bash
python fix_openapi.py
```

**To specify custom paths:**

```bash
python fix_openapi.py --input path/to/your/api.yaml --dictionary path/to/your/translations.json --output generated/docs/
```

-----

### A Note on Source File Integrity

This script is designed to clean and enrich a structurally sound OpenAPI file. It **cannot** fix API design inconsistencies present in the source `openapi.yaml`.

You **must manually correct** errors in your source file flagged by validators, such as:

  - `Operation must define parameter "{param}" as expected by path`: A parameter in the URL is missing from the operation's `parameters` list.
  - `Parameter "name" must be used in path`: A parameter is incorrectly marked as `in: path` when it should be `in: query`.

Fixing these issues in the source file is a prerequisite for getting a 100% valid final output.
